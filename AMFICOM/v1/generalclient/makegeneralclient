HOME=.
LIB=$(HOME)\..\AMFICOMCommon
LIBSRC=$(HOME)\..\AMFICOMCommon\src
EXTLIB=d:\lib91
ORACLE_HOME=d:\oracle\ora91
SRC=$(HOME)\src
SRCTEST=$(HOME)\test
CLASSES=$(HOME)\classes
CLASSES_TEST=$(HOME)\classes_test

JAVAC=javac
JAR=jar

TARGET=$(LIB)\generalclient.jar
TARGET_CLASS_LIST=src_generalclient.txt
TARGET_SRC=$(LIBSRC)\generalclientsource.jar

TEST_CLASS_LIST=src_generalclienttest.txt

SERVERCP=$(LIB)\corba.jar
CLIENTCP=$(LIB)\utilclient.jar;$(LIB)\corbaportable-common.jar;$(LIB)\filter.jar

ORBCP=$(EXTLIB)\aurora_client_orbindep.jar;$(EXTLIB)\aurora_client_orbdep.jar
VBJCP=$(ORACLE_HOME)\lib\vbjorb.jar;$(ORACLE_HOME)\lib\vbjapp.jar
LAYOUTCP=$(EXTLIB)\layout.jar;$(EXTLIB)\kunststoff.jar
SPATIALCP=$(EXTLIB)\ofx.spatialfx.jar
REPORTCP=$(EXTLIB)\jfreechartK.jar
JGRAPHCP=$(EXTLIB)\jgraphpad.jar
JUNITCP=$(EXTLIB)\junit.jar


.PHONY:	$(TARGET)

$(TARGET):	clean impl tst loc jar

jar:
	$(JAR) -cf $(TARGET) -C $(CLASSES) com
	$(JAR) -cf $(TARGET_SRC) -C $(SRC) com

impl:
	$(JAVAC) \
		-deprecation \
		-d $(CLASSES) \
		-classpath $(SERVERCP);$(CLIENTCP);$(LAYOUTCP);$(SPATIALCP);$(REPORTCP);$(JGRAPHCP);$(VBJCP);$(ORBCP);$(JUNITCP) \
		-sourcepath $(SRC) \
		@$(TARGET_CLASS_LIST)

tst:
	$(JAVAC) \
		-deprecation \
		-d $(CLASSES_TEST) \
		-classpath $(CLASSES);$(SERVERCP);$(CLIENTCP);$(LAYOUTCP);$(SPATIALCP);$(REPORTCP);$(JGRAPHCP);$(VBJCP);$(ORBCP);$(JUNITCP) \
		-sourcepath $(SRCTEST) \
		@$(TEST_CLASS_LIST)

loc:
	cp -f \
		src\com\syrus\AMFICOM\Client\General\Lang\*.properties \
		$(CLASSES)\com\syrus\AMFICOM\Client\General\Lang\

	md $(CLASSES)\com\syrus\AMFICOM\Client\Resource\Alarm\util

	cp -f \
		src\com\syrus\AMFICOM\Client\Resource\Alarm\util\*.properties \
		$(CLASSES)\com\syrus\AMFICOM\Client\Resource\Alarm\util\

clean:
	rm -rf $(CLASSES)\com
	rm -f $(TARGET) $(TARGET_SRC)
